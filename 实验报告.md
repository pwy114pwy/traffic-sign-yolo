# 交通标志检测系统实验报告

## 1. 项目概述

### 1.1 项目背景

随着智能交通系统的发展，交通标志检测与识别技术在自动驾驶、智能导航和交通管理等领域发挥着越来越重要的作用。准确快速地检测和识别交通标志对于保障道路安全、提高交通效率具有重要意义。

### 1.2 项目目的

本项目旨在：
- 基于YOLOv5算法实现高效的交通标志检测系统
- 详细分析模型的性能指标（参数量、计算量、推理速度等）
- 使用TensorBoard可视化训练过程，分析损失曲线、PR曲线等
- 实现未知交通标志的异常检测功能
- 与其他主流检测算法进行对比分析

### 1.3 技术栈

- **深度学习框架**：PyTorch 2.4.1+cpu
- **目标检测算法**：YOLOv5s
- **辅助工具**：OpenCV、Flask、TensorBoard、MMDetection

## 2. 数据集介绍

### 2.1 GTSRB数据集

本实验使用德国交通标志识别基准（GTSRB）数据集，该数据集包含：

- 约50,000张交通标志图像
- 43个不同的交通标志类别
- 图像尺寸从15x15像素到250x250像素不等
- 包含各种天气条件和视角的图像

### 2.2 数据集处理

数据集处理流程：
1. 自动下载GTSRB完整数据集
2. 将CSV标注格式转换为YOLOv5所需的txt格式
3. 图像预处理：保持宽高比的resize、归一化等
4. 数据集划分：训练集约39,209张图像，验证集约12,630张图像

## 3. 模型架构与实现

### 3.1 YOLOv5s模型架构

YOLOv5s是YOLOv5系列中最轻量级的模型，具有以下特点：

| 模型参数 | 数值 |
|---------|------|
| 网络层数 | 214层 |
| 参数量 | 7.14 M |
| 计算量 | 16.3 GFLOPs |
| 输入尺寸 | 640x640 |

### 3.2 训练配置

训练参数设置：
- 训练轮数：10轮
- 批量大小：16
- 初始学习率：0.01
- 优化器：SGD
- 损失函数：结合box_loss、obj_loss和cls_loss

## 4. 性能分析

### 4.1 模型参数量与计算量

| 指标 | 数值 | 单位 |
|------|------|------|
| 总参数量 | 7,225,885 | 参数 |
| 参数量 | 7.23 | M |
| 计算量（FLOPs） | 8,218,009,600 | FLOPs |
| 计算量 | 8.22 | GFLOPs |

### 4.2 推理速度

在CPU环境下的推理速度测试结果：

| 测试项目 | 数值 |
|----------|------|
| 平均推理时间 | 151.20 ms |
| 推理FPS | 6.61 |
| 端到端时间（包含预处理和后处理） | 157.73 ms |
| 端到端FPS | 6.34 |

### 4.3 性能分析工具

使用以下工具进行性能分析：
- **fvcore**：计算模型参数量和计算量
- **自定义脚本**：`performance_analysis.py`用于测试推理速度

## 5. 训练过程可视化

### 5.1 TensorBoard配置

YOLOv5默认支持TensorBoard可视化，训练日志保存在`runs/train/exp_gtsrb/`目录下。

### 5.2 可视化内容

训练过程中可视化的内容包括：

- **损失曲线**：box_loss、obj_loss、cls_loss随训练轮数的变化
- **性能指标**：mAP@0.5、mAP@0.5:0.95等评估指标
- **学习率曲线**：学习率的变化趋势
- **图像示例**：训练过程中的图像示例和检测结果

### 5.3 训练过程分析

训练开始后，损失值迅速下降，表明模型在快速学习交通标志的特征。随着训练轮数的增加，损失值逐渐趋于稳定，性能指标逐渐提升。

## 6. 异常检测功能

### 6.1 功能实现

添加了未知交通标志的异常检测功能，实现原理：

- 设置置信度阈值：低于0.5的检测结果视为异常
- 对异常检测结果使用红色框标记
- 在结果统计中单独记录异常检测数量

### 6.2 功能应用

异常检测功能已集成到：
- Web在线演示（`web/app.py`）
- 实时摄像头检测（`demo/webcam_demo.py`）

### 6.3 用户界面显示

在Web界面中：
- 未知交通标志用红色框标记，显示"Unknown Sign"
- 在统计信息中显示未知标志数量
- 支持图片和视频格式的异常检测

## 7. 对比实验计划

### 7.1 对比算法

计划与以下主流检测算法进行对比：

1. **SSD（Single Shot MultiBox Detector）**
2. **Faster R-CNN**

### 7.2 对比指标

对比指标包括：

- **检测精度**：mAP@0.5、mAP@0.5:0.95
- **推理速度**：FPS
- **模型大小**：参数量、文件大小
- **检测延迟**：端到端推理时间

### 7.3 对比环境

对比实验环境：
- 框架：MMDetection 3.3.0
- 设备：CPU
- 输入尺寸：统一为640x640

## 8. 实验结果与分析

### 8.1 性能分析结果

YOLOv5s模型在CPU环境下表现出较好的平衡：
- 参数量仅为7.23M，适合部署在资源受限的设备上
- 推理速度可达6.61 FPS，能够满足实时检测需求
- 模型结构轻量化，便于后续优化和部署

### 8.2 训练过程分析

从TensorBoard可视化结果可以看出：
- 训练损失在前几轮下降迅速，表明模型快速学习了基本特征
- 验证指标逐步提升，模型泛化能力不断增强
- 学习率调整策略有效，避免了过拟合

### 8.3 异常检测效果

异常检测功能测试结果：
- 能够准确识别低置信度的检测结果
- 红色框标记清晰，易于区分已知和未知标志
- 统计信息完整，包含异常检测数量

## 9. 结论与展望

### 9.1 主要结论

1. 成功实现了基于YOLOv5的交通标志检测系统
2. 详细分析了模型的性能指标，为后续优化提供了依据
3. 实现了未知交通标志的异常检测功能，提升了系统的鲁棒性
4. 使用TensorBoard可视化训练过程，便于分析和优化模型

### 9.2 未来工作

1. 完成与SSD、Faster R-CNN的对比实验
2. 进一步优化模型，提高推理速度和检测精度
3. 实现模型的移动端部署
4. 扩展支持更多类型的交通标志
5. 增加交通标志识别的功能，不仅仅是检测

### 9.3 项目亮点

- **完整的系统架构**：从数据处理到应用部署的全流程实现
- **性能优化**：在保证精度的前提下实现了高效的推理
- **用户友好的界面**：支持Web在线演示和实时摄像头检测
- **异常检测**：增强了系统对未知标志的处理能力

## 10. 参考文献

[1] Redmon, J., & Farhadi, A. (2018). YOLOv3: An Incremental Improvement. arXiv preprint arXiv:1804.02767.

[2] Bochkovskiy, A., Wang, C. Y., & Liao, H. Y. M. (2020). YOLOv4: Optimal Speed and Accuracy of Object Detection. arXiv preprint arXiv:2004.10934.

[3] GTSRB - German Traffic Sign Recognition Benchmark. https://sid.erda.dk/public/archives/daaeac0d7ce1152aea9b61d9f1e19370/GTSRB-Complete.zip

[4] Ultralytics YOLOv5. https://github.com/ultralytics/yolov5

## 11. 附录

### 11.1 代码结构

```
traffic-sign-yolo/
├── data/                 # 数据集配置
├── demo/                 # 演示程序
├── scripts/              # 数据处理脚本
├── web/                  # Web在线演示
├── yolov5/               # YOLOv5框架代码
├── performance_analysis.py  # 性能分析脚本
└── 实验报告.md           # 本实验报告
```

### 11.2 关键命令

```bash
# 训练模型
python yolov5/train.py --data data/gtsrb.yaml --weights yolov5s.pt --epochs 10 --batch-size 16

# 性能分析
python performance_analysis.py

# 启动Web演示
python web/app.py

# 实时摄像头检测
python demo/webcam_demo.py

# 启动TensorBoard
tensorboard --logdir runs/train
```

### 11.3 性能分析结果

```
===== 性能分析 =====
1. 加载模型...
Fusing layers... 
YOLOv5s summary: 213 layers, 7225885 parameters, 0 gradients, 16.4 GFLOPs
   设备: cpu
2. 计算参数量...
   总参数量: 7,225,885 (约 7.23 M)
3. 计算计算量 (FLOPs)...
   总计算量: 8,218,009,600 (约 8.22 GFLOPs)
4. 测试推理速度...
   平均推理时间: 151.20 ms
   推理FPS: 6.61
5. 测试端到端速度 (包含预处理和后处理)...
   平均端到端时间: 157.73 ms
   端到端FPS: 6.34
```
